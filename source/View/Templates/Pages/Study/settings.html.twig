{% from "Components/_macros.html.twig" import sectionHelp %}

{% extends "Layouts/threeColumn.html.twig" %}

{% set isPartOfStudyDocumentation = true %}

{% block title %}
    {{ "title.settings.title"|trans }}
{% endblock %}

{% block content %}
    <h2 class="MetaDataGroup-Title">
        {{ "title.settings.title"|trans }}
    </h2>

    {{ form_start(form) }}
    {{ form_errors(form) }}

    <fieldset>
        <div class="MetaData-Title">
            <legend class="MetaData-Legend">
                {{ "input.study-name.legend"|trans }}
            </legend>

        </div>
        <div class="MetaData-Label">
            {{ form_label(form.shortName, null, {
                'label': 'input.study-name.label',
                'label_attr': {
                    'class': 'block max-w-prose'
                },
            }) }}
        </div>
        {{ form_errors(form.shortName) }}
        <div class="mt-1 md:items-center md:flex MetaData-Widget">
            {{ form_widget(form.shortName, {
                'attr': {
                    'class': 'w-full md:w-3/4',
                    'x-init': '$el.focus()',
                }
            }) }}
            {{ form_widget(form.submit, {
                'attr': {
                    'class': 'Button Button_primary Button_primary_act Button_standalone mt-1 md:mt-0 md:ml-2',
                },
                'label': "generic.rename"
            }) }}
        </div>
    </fieldset>


    <fieldset class="pb-8 mt-[6.25rem]" x-data="modal()" @keydown.window.escape="hide()">
        <div class="MetaData-Title">
            <legend class="MetaData-Legend">
                {{ "input.danger-zone.legend"|trans }}
            </legend>
            {# {{ helpButton("title") }} #}
        </div>
        <div class="MetaData-Label">
            {{ "input.danger-zone.label"|trans }}
        </div>
        <div class="!p-4 mx-6 border border-red-500 rounded MetaData-Widget mt-2">
            <h4 class="text-lg font-semibold">{{ "input.danger-zone.delete.title"|trans }}</h4>
            <div class="">
                <div class="mt-2">
                    {{ "input.danger-zone.delete.description"|trans }}
                </div>
                <button class="inline-flex items-center self-start mt-4 Button Button_secondary Button_secondary_danger Button_standalone"
                        @click="show()" type="button">
                    <svg class="mr-0.5" xmlns="http://www.w3.org/2000/svg"
                         xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img"
                         width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24">
                        <g fill="none">
                            <path d="M7 4a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2h4a1 1 0 1 1 0 2h-1.069l-.867 12.142A2 2 0 0 1 17.069 22H6.93a2 2 0 0 1-1.995-1.858L4.07 8H3a1 1 0 0 1 0-2h4V4zm2 2h6V4H9v2zM6.074 8l.857 12H17.07l.857-12H6.074zM10 10a1 1 0 0 1 1 1v6a1 1 0 1 1-2 0v-6a1 1 0 0 1 1-1zm4 0a1 1 0 0 1 1 1v6a1 1 0 1 1-2 0v-6a1 1 0 0 1 1-1z"
                                  fill="currentColor"/>
                        </g>
                    </svg>
                    {{ "input.danger-zone.delete.action"|trans }}
                </button>
            </div>
        </div>

        <!-- Modal confirming delete action -->
        <div class="Modal-Overlay" x-bind="overlay" x-cloak>
            <div class="Modal-Dialog" @click.outside="hide()">

                <div class="Modal-Header">
                    <div class="Modal-Title">
                        {{ "title.dataset.deleteModal.title"|trans }}
                    </div>
                    <button class="Modal-Button_close" @click="hide()" type="button">
                        <span class="w-6 h-6 iconify" data-icon="mdi:close" data-inline="false"></span>
                    </button>
                </div>

                <div class="Modal-Body">
                    {{ "title.settings.deleteModal.body"|trans({'#studyName#':"<span class='font-semibold'>" ~ experiment.settingsMetaDataGroup.shortName ~ "</span>"})|raw }}
                </div>

                <div class="Modal-Footer">
                    <button class="Button Button_primary Button_primary_danger Button_standalone" type="button"
                            @click="window.location.href='{{ path('Study-delete', { "uuid": experiment.id }) }}'"
                    >
                        {{ "title.settings.deleteModal.confirm"|trans }}
                    </button>
                    <button class="ml-2 Button Button_tertiary Button_tertiary_act Button_standalone" type="button"
                            x-ref="focusFirst" @click="hide()">
                        {{ "generic.cancel"|trans }}
                    </button>
                </div>
            </div>
        </div>
    </fieldset>

    {{ form_end(form) }}
{% endblock %}

{% block help_for_section %}
    {{ sectionHelp("settings") }}
{% endblock %}
