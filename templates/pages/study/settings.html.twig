{% from "components/_macros.html.twig" import sectionHelp %}

{% extends "layouts/threeColumn.html.twig" %}

{% set isPartOfStudyDocumentation = true %}

{% block title %}
    {{ "title.settings.title"|trans }}
{% endblock %}

{% block content %}
    <h2 class="MetaDataGroup-Title">
        {{ "title.settings.title"|trans }}
    </h2>

    {{ form_start(form) }}
    {{ form_errors(form) }}

    <fieldset>
        <div class="MetaData-Title">
            <legend class="MetaData-Legend">
                {{ "input.documentation-name.legend"|trans }}
            </legend>

        </div>
        <div class="MetaData-Label">
            {{ form_label(form.shortName, null, {
                'label': 'input.documentation-name.label',
                'label_attr': {
                    'class': 'block max-w-prose'
                },
            }) }}
        </div>
        {{ form_errors(form.shortName) }}
        <div class="mt-1 md:items-center md:flex MetaData-Widget">
            {{ form_widget(form.shortName, {
                'attr': {
                    'class': 'w-full md:w-3/4',
                    'x-init': '$el.focus()',
                }
            }) }}
            {{ form_widget(form.submit, {
                'attr': {
                    'class': 'Button Button_primary Button_primary_act Button_standalone mt-1 md:mt-0 md:ml-2',
                },
                'label': "generic.rename"
            }) }}
        </div>
    </fieldset>


    <fieldset class="pb-8 mt-[6.25rem]" x-data="modal()" @keydown.window.escape="hide()">
        <div class="MetaData-Title">
            <legend class="MetaData-Legend">
                {{ "input.danger-zone.legend"|trans }}
            </legend>
            {# {{ helpButton("title") }} #}
        </div>
        <div class="MetaData-Label">
            {{ "input.danger-zone.label"|trans }}
        </div>
        <div class="!p-4 mx-6 border border-red-500 rounded MetaData-Widget mt-2">
            <h4 class="text-lg font-semibold">{{ "input.danger-zone.delete.title"|trans }}</h4>
            <div class="">
                <div class="mt-2">
                    {{ "input.danger-zone.delete.description"|trans }}
                </div>
                <button class="inline-flex items-center self-start mt-4 Button Button_secondary Button_secondary_danger Button_standalone"
                        @click="show()" type="button">
                    {{ include('components/icons/delete.svg') }}
                    {{ "input.danger-zone.delete.action"|trans }}
                </button>
            </div>
        </div>

        <!-- Modal confirming delete action -->
        <div class="Modal-Overlay" x-bind="overlay" x-cloak>
            <div class="Modal-Dialog" @click.outside="hide()">

                <div class="Modal-Header">
                    <div class="Modal-Title">
                        {{ "title.dataset.deleteModal.title"|trans }}
                    </div>
                    <button class="Modal-Button_close" @click="hide()" type="button">
                        {{ include('components/icons/close.svg') }}
                    </button>
                </div>

                <div class="Modal-Body">
                    {{ "title.settings.deleteModal.body"|trans({'#studyName#':"<span class='font-semibold'>" ~ experiment.settingsMetaDataGroup.shortName ~ "</span>"})|raw }}
                </div>

                <div class="Modal-Footer">
                    <button class="Button Button_primary Button_primary_danger Button_standalone" type="button"
                            @click="window.location.href='{{ path('Study-delete', { "uuid": experiment.id }) }}'"
                    >
                        {{ "title.settings.deleteModal.confirm"|trans }}
                    </button>
                    <button class="ml-2 Button Button_tertiary Button_tertiary_act Button_standalone" type="button"
                            x-ref="focusFirst" @click="hide()">
                        {{ "generic.cancel"|trans }}
                    </button>
                </div>
            </div>
        </div>
    </fieldset>

    {{ form_end(form) }}
{% endblock %}

{% block help_for_section %}
    {{ sectionHelp("settings") }}
{% endblock %}
